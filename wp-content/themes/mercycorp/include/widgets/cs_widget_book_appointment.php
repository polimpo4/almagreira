<?php/* * Widget Name: CS: Book Appointment */class cs_widget_book_appointment extends WP_Widget {    public function __construct() {        parent::__construct(                'cs_widget_book_appointment', // Base ID                __('CS: Book Appointments', 'Mercycorp'), // Name                array('classname' => 'cs_widget_book_appointment', 'description' => 'Lets visitors Book Appointments on Home Page.',) // Args        );    }    // Displays Form on the WPAdmin side in main page for Widgets Arrangements/Settings.    function form($instance) {        //parent::form($instance);        $instance = wp_parse_args((array) $instance, array('title' => '', 'description' => '', 'site_phone' => '1-800-643-4300', 'site_email' => 'medicenter@mail.com'));        $title = $instance['title'];        $description = $instance['description'];        $site_phone = $instance['site_phone'];        $site_email = $instance['site_email'];        $get_post_slug = isset($instance['get_post_slug']) ? esc_attr($instance['get_post_slug']) : '';        ?>        <p>            <label for="<?php echo $this->get_field_id('title'); ?>">                Title:                 <br />                <input class="widefat" id="<?php echo $this->get_field_id('title'); ?>" size="40" name="<?php echo $this->get_field_name('title'); ?>" type="text" value="<?php echo esc_attr($title); ?>" />            </label>        </p>        <p>            <label for="<?php echo $this->get_field_id('description'); ?>">                Description:                 <br />                <input class="widefat" id="<?php echo $this->get_field_id('description'); ?>" size="40" name="<?php echo $this->get_field_name('description'); ?>" type="text" value="<?php echo esc_attr($description); ?>" />            </label>        </p>        <p>            <label for="<?php echo $this->get_field_id('site_phone'); ?>">                Website Phone:                 <br />                <input class="widefat" id="<?php echo $this->get_field_id('site_phone'); ?>" size="40" name="<?php echo $this->get_field_name('site_phone'); ?>" type="text" value="<?php echo esc_attr($site_phone); ?>" />            </label>        </p>        <p>            <label for="<?php echo $this->get_field_id('site_email'); ?>">                Website Email:                 <br />                <input class="widefat" id="<?php echo $this->get_field_id('site_email'); ?>" size="40" name="<?php echo $this->get_field_name('site_email'); ?>" type="text" value="<?php echo esc_attr($site_email); ?>" />            </label>        </p>        <?php    }    function update($new_instance, $old_instance) {        //parent::update($new_instance, $old_instance);        $instance = $old_instance;        $instance['title'] = $new_instance['title'];        $instance['description'] = $new_instance['description'];        $instance['site_phone'] = $new_instance['site_phone'];        $instance['site_email'] = $new_instance['site_email'];        //$instance['img_url'] = $new_instance['img_url'];        $instance['get_post_slug'] = $new_instance['get_post_slug'];        return $instance;    }    // Displays Widget on the Frontend to visitors     function widget($args, $instance) {        //parent::widget($args, $instance);        extract($args, EXTR_SKIP);        $instance = wp_parse_args((array) $instance, array('appnt_fname' => 'Full Name', 'appnt_email' => 'Email Address', 'appnt_phone' => 'Phone Number', 'appnt_date' => '01/dd/yyyy'));        global $post;        //print_r($_POST);        //widget-cs_widget_book_appointment[3][appnt_fname]        //echo is_array($_POST['widget-cs_widget_book_appointment'][$this->number]['appnt_fname'] ) ? '<p>is_array</p>' : '<p>NOT is_array</p>' ;        echo $_POST['widget-cs_widget_book_appointment'][$this->number]['appnt_fname'];        echo $_POST['widget-cs_widget_book_appointment'][$this->number]['appnt_email'];        echo $_POST['widget-cs_widget_book_appointment'][$this->number]['appnt_phone'];        echo $_POST['widget-cs_widget_book_appointment'][$this->number]['appnt_date'];        //echo $this->id." : ". $_POST['appnt_fname_' . $this->id];        $title = empty($instance['title']) ? ' ' : apply_filters('widget_title', $instance['title']);        $description = empty($instance['description']) ? ' ' : apply_filters('widget_description', $instance['description']);        $site_phone = empty($instance['site_phone']) ? ' ' : apply_filters('widget_site_phone', $instance['site_phone']);        $site_email = empty($instance['site_email']) ? ' ' : apply_filters('widget_site_email', $instance['site_email']);        $appnt_fname = empty($_POST['widget-cs_widget_book_appointment'][$this->number]['appnt_fname']) ? ' ' : $_POST['widget-cs_widget_book_appointment'][$this->number]['appnt_fname'];        $instance['appnt_fname'] = $appnt_fname;        $appnt_email = empty($_POST['widget-cs_widget_book_appointment'][$this->number]['appnt_email']) ? ' ' : $_POST['widget-cs_widget_book_appointment'][$this->number]['appnt_email'];        $instance['appnt_email'] = $appnt_email;        $appnt_phone = empty($_POST['widget-cs_widget_book_appointment'][$this->number]['appnt_phone']) ? ' ' : $_POST['widget-cs_widget_book_appointment'][$this->number]['appnt_phone'];        $instance['appnt_phone'] = $appnt_phone;        $appnt_date = empty($_POST['widget-cs_widget_book_appointment'][$this->number]['appnt_date']) ? ' ' : $_POST['widget-cs_widget_book_appointment'][$this->number]['appnt_date'];        $instance['appnt_date'] = $appnt_date;        echo $before_widget; // WIDGET display CODE Starts        $get_post_slug = isset($instance['get_post_slug']) ? esc_attr($instance['get_post_slug']) : '';        ?>        <!-- Appointment Section Start-->        <div id="cs-appointment">            <h2 class="title"><?php echo substr($title, 0, 20); /* strlength -> check */ if (strlen($title) > 20) echo "..."; ?></h2>            <p><?php                if (strlen($description) > 75) {                    echo substr($description, 0, 75) . " ...";                } else                    echo $description; /* We are Wow quizzical mightily within quetzal one wow python via salmon */                ?></p>            <form action="" method="post">                <ul>                    <li><label><input id="<?php echo $this->get_field_id('appnt_fname'); ?>" name="<?php echo $this->get_field_name('appnt_fname'); ?>" value="<?php echo esc_attr($appnt_fname); ?>" placeholder="Full Name" type="text"><i class="fa fa-user"></i></label></li>                    <li><label><input id="<?php echo $this->get_field_id('appnt_email'); ?>" name="<?php echo $this->get_field_name('appnt_email'); ?>" value="<?php echo esc_attr($appnt_email); ?>" placeholder="Email Address" type="text"><i class="fa fa-envelope"></i></label></li>                    <li><label><input id="<?php echo $this->get_field_id('appnt_phone'); ?>" name="<?php echo $this->get_field_name('appnt_phone'); ?>" value="<?php echo esc_attr($appnt_phone); ?>" placeholder="Phone Number" type="text"><i class="fa fa-phone"></i></label></li>                    <li><label class="cs-calendar-combo"><input id="<?php echo $this->get_field_id('appnt_date'); ?>" name="<?php echo $this->get_field_name('appnt_date'); ?>" value="<?php echo esc_attr($appnt_date); ?>" placeholder="01/dd/yyyy" type="text"><i class="fa fa-calendar"></i></label></li>                    <li><input class="btn cs-bgcolr-alt" value="Enviar" type="submit"><span><span><?php echo $site_phone; ?> <a href="mailto:<?php echo $site_email; ?>"><?php echo $site_email; ?></a></span></li>                </ul>            </form><!-- Appointment Booking Form - END -->        </div>        <!-- Appointment Section Close-->        <?php        echo $after_widget; // WIDGET display CODE Ends    }}add_action('widgets_init', create_function('', 'return register_widget("cs_widget_book_appointment");'));?>